<div class="votes">
  <% if user_signed_in? && !local_assigns[:inactive] %>
    <span class="in_favor">
      <% if can?(:vote, comment) %>
        <%= link_to vote_comment_path(comment, value: 'yes'),
            method: "post", remote: true, title: t('votes.agree') do %>
            <span class="icon-like">
              <span class="show-for-sr"><%= t('votes.agree') %></span>
            </span>
        <% end %>
      <% else %>
        <%= link_to new_user_session_path do %>
          <span class="icon-like">
            <span class="show-for-sr"><%= t('votes.agree') %></span>
          </span>
        <% end %>
      <% end %>
      <%= comment.total_likes %>
    </span>

    <span class="against">
      <% if can?(:vote, comment) %>
        <%= link_to vote_comment_path(comment, value: 'no'),
            method: "post", remote: true, title: t('votes.disagree') do %>
            <span class="icon-unlike">
              <span class="show-for-sr"><%= t('votes.disagree') %></span>
            </span>
        <% end %>
      <% else %>
        <span class="icon-unlike">
          <span class="show-for-sr"><%= t('votes.disagree') %></span>
        </span>
      <% end %>
      <%= comment.total_dislikes %>
    </span>
    <% if comment.commentable.is_proposal && !Proposal.in_active_period? %>
      <div class="participation-not-allowed" style='display:none' aria-hidden="false">
        <%= t("proposals.inactive",
              date_from: @proposal_date_from,
              date_to: @proposal_date_to).html_safe %>
      </div>
    <% elsif !comment.commentable.is_proposal && !Proposal.legislation_in_active_period? %>
      <div class="participation-not-allowed" style='display:none' aria-hidden="false">
        <%= t("legislation_proposals.inactive",
              date_from: @proposal_date_from,
              date_to: @proposal_date_to).html_safe %>
      </div>
    <% end %>

  <% elsif !user_signed_in? %>

    <div class="participation-allowed">
      <%= t('comments.comment.votes', count: comment.total_votes) %>
      &nbsp;|&nbsp;

      <span class="in_favor">
        <% if can?(:vote, comment) %>
          <%= link_to vote_comment_path(comment, value: 'yes'),
              method: "post", remote: true, title: t('votes.agree') do %>
              <span class="icon-like">
                <span class="show-for-sr"><%= t('votes.agree') %></span>
              </span>
          <% end %>
        <% else %>
          <%= link_to new_user_session_path do %>
            <span class="icon-like">
              <span class="show-for-sr"><%= t('votes.agree') %></span>
            </span>
          <% end %>
        <% end %>
        <%= comment.total_likes %>
      </span>

      <span class="against">
        <% if can?(:vote, comment) %>
          <%= link_to vote_comment_path(comment, value: 'no'),
              method: "post", remote: true, title: t('votes.disagree') do %>
              <span class="icon-unlike">
                <span class="show-for-sr"><%= t('votes.disagree') %></span>
              </span>
          <% end %>
        <% else %>
          <%= link_to new_user_session_path do %>
            <span class="icon-unlike">
              <span class="show-for-sr"><%= t('votes.disagree') %></span>
            </span>
          <% end %>
        <% end %>
        <%= comment.total_dislikes %>
      </span>
    </div>

    <div class="participation-not-allowed" style='display:none' aria-hidden="false">
      <%= t("votes.comment_unauthenticated",
        signin: link_to(t("votes.signin"), new_user_session_path),
        signup: link_to(t("votes.signup"), new_user_registration_path)).html_safe %>
    </div>
  <% else %>
    <div class="participation-allowed">
      <%= t('comments.comment.votes', count: comment.total_votes) %>
      &nbsp;|&nbsp;

      <span class="in_favor">
        <% if can?(:vote, comment) %>
          <%= link_to vote_comment_path(comment, value: 'yes'),
                      method: "post", remote: true, title: t('votes.agree') do %>
              <span class="icon-like">
                <span class="show-for-sr"><%= t('votes.agree') %></span>
              </span>
          <% end %>
        <% else %>
          <%= link_to new_user_session_path do %>
            <span class="icon-like">
              <span class="show-for-sr"><%= t('votes.agree') %></span>
            </span>
          <% end %>
        <% end %>
        <%= comment.total_likes %>
      </span>

      <span class="against">
        <% if can?(:vote, comment) %>
          <%= link_to vote_comment_path(comment, value: 'no'),
                      method: "post", remote: true, title: t('votes.disagree') do %>
              <span class="icon-unlike">
                <span class="show-for-sr"><%= t('votes.disagree') %></span>
              </span>
          <% end %>
        <% else %>
          <%= link_to new_user_session_path do %>
            <span class="icon-unlike">
              <span class="show-for-sr"><%= t('votes.disagree') %></span>
            </span>
          <% end %>
        <% end %>
        <%= comment.total_dislikes %>
      </span>
    </div>
    <% if @proposal.is_proposal %>
      <div class="participation-not-allowed" style='display:none' aria-hidden="false">
        <%= t("proposals.inactive",
              date_from: @proposal_date_from,
              date_to: @proposal_date_to).html_safe %>
      </div>
    <% else %>
      <div class="participation-not-allowed" style='display:none' aria-hidden="false">
        <%= t("legislation_proposals.inactive",
              date_from: @proposal_date_from,
              date_to: @proposal_date_to).html_safe %>
      </div>
    <% end %>
  <% end %>
</div>
